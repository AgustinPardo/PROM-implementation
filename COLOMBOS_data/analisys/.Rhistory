#quantile
library("preprocessCore")
colombos_GSM27855_quantile=normalize.quantiles(colombos_GSM27855)
boxplot(colombos_GSM27855_quantile,outline=FALSE)
# normalize
library("EnrichmentBrowser")
maSE <- normalize(colombos_GSM27855)
select=colombos_GSE16811
colombos_GSE16811 <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/analisys/colombos_GSE16811.txt",  row.names=1, dec = "." ,skip=7,  header=FALSE, fill=TRUE)
select=colombos_GSE16811
colombos_GSM27855 <- as.matrix (select)
boxplot(colombos_GSM27855,outline=FALSE)
y2 <- normalizeBetweenArrays(log2(colombos_GSM27855), method="quantile")
boxplot(y2,outline=FALSE)
y2 <- normalizeBetweenArrays(log2(colombos_GSM27855), method="Tquantile")
boxplot(y2,outline=FALSE)
y2 <- normalizeBetweenArrays(log2(colombos_GSM27855), method="Tquantile")
#quantile
library("preprocessCore")
colombos_GSM27855_quantile=normalize.quantiles(select)
colombos_GSM27855 <- as.matrix (select)
colombos_GSM27855_quantile=normalize.quantiles(select)
colombos_GSM27855
# exp colombos GSE1642
colombos_GSM27855 <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/analisys/colombos_GSE1642.txt",  row.names=1, dec = "." ,skip=7,  header=FALSE, fill=TRUE)
colombos_GSE16811 <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/analisys/colombos_GSE16811.txt",  row.names=1, dec = "." ,skip=7,  header=FALSE, fill=TRUE)
colombos_GSM27855_quantile=normalize.quantiles(colombos_GSM27855)
select=colombos_GSE16811
colombos_GSM27855_quantile=normalize.quantiles(select)
colombos_GSM27855_quantile=normalize.quantiles(colombos_GSM27855)
colombos_GSM27855 <- as.matrix (select)
colombos_GSM27855_quantile=normalize.quantiles(colombos_GSM27855)
boxplot(colombos_GSM27855_quantile,outline=FALSE)
colombos_9776 <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_9776.txt",  row.names=1, dec = "." ,skip=7,  header=FALSE, fill=TRUE)
select=colombos_9776
colombos_GSM27855 <- as.matrix (select)
boxplot(colombos_GSM27855,outline=FALSE)
y2 <- normalizeBetweenArrays(log2(colombos_GSM27855), method="quantile")
boxplot(y2,outline=FALSE)
colombos_GSM27855_quantile=normalize.quantiles(select)
select <- as.matrix (select)
colombos_GSM27855_quantile=normalize.quantiles(select)
boxplot(colombos_GSM27855_quantile,outline=FALSE)
colombos_16811_40846_9776 <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_colombos_16811_40846_9776.txt",  row.names=1, dec = "." ,skip=7,  header=FALSE, fill=TRUE)
colombos_16811_40846_9776 <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_16811_40846_9776.txt",  row.names=1, dec = "." ,skip=7,  header=FALSE, fill=TRUE)
select <- as.matrix (colombos_16811_40846_9776)
boxplot(colombos_GSM27855,outline=FALSE)
select <- as.matrix (colombos_16811_40846_9776)
boxplot(select,outline=FALSE)
y2 <- normalizeBetweenArrays(log2(select), method="quantile")
boxplot(y2,outline=FALSE)
#quantile
library("preprocessCore")
colombos_GSM27855_quantile=normalize.quantiles(select)
boxplot(colombos_GSM27855_quantile,outline=FALSE)
#ComBat
BiocManager::install("bladderbatch")
#ComBat
#BiocManager::install("bladderbatch")
library("bladderbatch")
data(bladderdata)
dat <- bladderEset[1:50,]
pheno = pData(dat)
edata = exprs(dat)
batch = pheno$batch
edata
batch
batch<-[1,1,1]
batch<- c(1,1,1)
batch
replicate(10, 0)
# 37 1
# 2 2
# 17 3
a=replicate(10, 0)
typeof(a)
b=replicate(10, 0)
typeof(a+b)
c=a+b
c
c=a,
batch<- c(1,1,1)
c=a,b
c=c(a,b)
c
# 37 1
# 2 2
# 17 3
a=replicate(37, 1)
b=replicate(2, 2)
b=replicate(17, 3)
batch<- c(a,b,c)
batch
dim(batch)
lenght(batch)
length(batch)
dim(colombos_GSM27855_quantile)
# 37 1
# 2 2
# 17 3
a=replicate(36, 1)
b=replicate(2, 2)
b=replicate(17, 3)
batch<- c(a,b,c)
length(batch)
batch
# 37 1
# 2 2
# 17 3
a=replicate(36, 1)
b=replicate(2, 2)
c=replicate(17, 3)
batch<- c(a,b,c)
length(batch)
# 37 1
# 2 2
# 17 3
a=replicate(35, 1)
b=replicate(2, 2)
c=replicate(17, 3)
batch<- c(a,b,c)
length(batch)
dim(colombos_GSM27855_quantile)
library("sva")
data_combat=ComBat(colombos_GSE16811, batch, mod=NULL, par.prior = TRUE, prior.plots = FALSE)
library("sva")
data_combat=ComBat(colombos_GSM27855_quantile, batch, mod=NULL, par.prior = TRUE, prior.plots = FALSE)
data_combat
#mod=NULL, par.prior = TRUE, prior.plots = FALSE
data_combat=ComBat(colombos_GSM27855_quantile, batch)
# 37 1
# 2 2
# 17 3
a=replicate(35, 1)
b=replicate(7, 2)
c=replicate(12, 3)
batch<- c(a,b,c)
length(batch)
dim(colombos_GSM27855_quantile)
library("sva")
#mod=NULL, par.prior = TRUE, prior.plots = FALSE
data_combat=ComBat(colombos_GSM27855_quantile, batch)
batch
colombos_GSM27855_quantile
data_combat=ComBat(colombos_GSM27855_quantile, batch, mod=NULL, par.prior = TRUE, prior.plots = FALSE)
View(edata)
data_combat=ComBat(dat=colombos_GSM27855_quantile, batch=batch, mod=NULL, par.prior = TRUE, prior.plots = FALSE)
colombos_GSM27855_quantile
colombos_GSM27855_quantile[is.na(colombos_GSM27855_quantile)] = 0
library("sva")
data_combat=ComBat(dat=colombos_GSM27855_quantile, batch=batch, mod=NULL, par.prior = TRUE, prior.plots = FALSE)
data_combat
boxplot(data_combat,outline=FALSE)
colombos_16811_40846_9776 <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_16811_40846_9776.txt",  row.names=1, dec = "." ,skip=7,  header=FALSE, fill=TRUE)
select <- as.matrix (colombos_16811_40846_9776)
boxplot(select,outline=FALSE)
y2 <- normalizeBetweenArrays(log2(select), method="quantile")
boxplot(y2,outline=FALSE)
colombos_GSM27855_quantile=normalize.quantiles(select)
boxplot(colombos_GSM27855_quantile,outline=FALSE)
boxplot(data_combat,outline=FALSE)
# 37 1
# 2 2
# 17 3
a=replicate(35, 1)
b=replicate(2, 2)
c=replicate(17, 3)
d=replicate(16, 4)
e=replicate(5,5)
batch<- c(a,b,c,d,e)
length(batch)
colombos_16811_40846_9776_35362_14840 <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_16811_40846_9776_35362_14840.txt",  row.names=1, dec = "." ,skip=7,  header=FALSE, fill=TRUE)
select <- as.matrix (colombos_16811_40846_9776)
boxplot(select,outline=FALSE)
colombos_16811_40846_9776_35362_14840 <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_16811_40846_9776_35362_14840.txt",  row.names=1, dec = "." ,skip=7,  header=FALSE, fill=TRUE)
select <- as.matrix (colombos_16811_40846_9776)
boxplot(select,outline=FALSE)
y2 <- normalizeBetweenArrays(log2(select), method="quantile")
boxplot(y2,outline=FALSE)
#quantile
library("preprocessCore")
colombos_GSM27855_quantile=normalize.quantiles(select)
boxplot(colombos_GSM27855_quantile,outline=FALSE)
#ComBat
#BiocManager::install("bladderbatch")
library("bladderbatch")
data(bladderdata)
dat <- bladderEset[1:50,]
pheno = pData(dat)
edata = exprs(dat)
batch = pheno$batch
# 37 1
# 2 2
# 17 3
a=replicate(35, 1)
b=replicate(2, 2)
c=replicate(17, 3)
d=replicate(16, 4)
e=replicate(5,5)
batch<- c(a,b,c,d,e)
length(batch)
dim(colombos_GSM27855_quantile)
library("sva")
select <- as.matrix (colombos_16811_40846_9776_35362_14840)
boxplot(select,outline=FALSE)
y2 <- normalizeBetweenArrays(log2(select), method="quantile")
boxplot(y2,outline=FALSE)
#quantile
library("preprocessCore")
colombos_GSM27855_quantile=normalize.quantiles(select)
boxplot(colombos_GSM27855_quantile,outline=FALSE)
# 37 1
# 2 2
# 17 3
a=replicate(35, 1)
b=replicate(2, 2)
c=replicate(17, 3)
d=replicate(16, 4)
e=replicate(5,5)
batch<- c(a,b,c,d,e)
length(batch)
dim(colombos_GSM27855_quantile)
e=replicate(6,5)
batch<- c(a,b,c,d,e)
length(batch)
dim(colombos_GSM27855_quantile)
library("sva")
colombos_GSM27855_quantile[is.na(colombos_GSM27855_quantile)] = 0
data_combat=ComBat(dat=colombos_GSM27855_quantile, batch=batch, mod=NULL, par.prior = TRUE, prior.plots = FALSE)
boxplot(data_combat,outline=FALSE)
# limma normalizeBetweenArrays
y2 <- normalizeBetweenArrays(log2(select), method="quantile")
boxplot(y2,outline=FALSE)
colombos_GSM27855_quantile[is.na(y2)] = 0
y2[is.na(y2)] = 0
data_combat=ComBat(dat=y2, batch=batch, mod=NULL, par.prior = TRUE, prior.plots = FALSE)
boxplot(data_combat,outline=FALSE)
plotMDS
#####
# MDS
mds = plotMDS(dge,xlim=c(-2,2) ,xlab = "Dim1", ylim=c(-2,2), ylab = "Dim2", cex.lab= 1.5,pch = 15,cex=2, col=c( rep("black",6),  rep("red",12), rep("yellow",12), rep("orange",12))) #,rep("green",3),rep("deeppink",3),rep("gray",3), rep("pink",3)))
#####
# MDS
mds = plotMDS(colombos_GSM27855_quantile,xlim=c(-2,2) ,xlab = "Dim1", ylim=c(-2,2), ylab = "Dim2", cex.lab= 1.5,pch = 15,cex=2, col=c( rep("black",6),  rep("red",12), rep("yellow",12), rep("orange",12))) #,rep("green",3),rep("deeppink",3),rep("gray",3), rep("pink",3)))
plotMDS(colombos_GSM27855_quantile,dim=c(3,4))
-
#####
# MDS
mds = plotMDS(colombos_GSM27855_quantile,xlim=c(-2,2) ,xlab = "Dim1", ylim=c(-2,2), ylab = "Dim2", cex.lab= 1.5,pch = 15,cex=2, col=c( rep("black",6),  rep("red",12), rep("yellow",12), rep("orange",12))) #,rep("green",3),rep("deeppink",3),rep("gray",3), rep("pink",3)))
#####
# MDS
mds = plotMDS(colombos_GSM27855_quantile,xlim=c(-2,2) ,xlab = "Dim1", ylim=c(-2,2), ylab = "Dim2", cex.lab= 1.5,pch = 15,cex=2, col=c( rep("black",6),  rep("red",12), rep("yellow",12), rep("orange",12))) #,rep("green",3),rep("deeppink",3),rep("gray",3), rep("pink",3)))
plotMDS(colombos_GSM27855_quantile,dim=c(3,4), col=batch)
select <- as.matrix (colombos_GSM27855)
boxplot(select,outline=FALSE)
select <- as.matrix (colombos_GSE16811)
boxplot(select,outline=FALSE)
# exp colombos GSE1642
colombos_GSE1642 <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/analisys/colombos_GSE1642.txt",  row.names=1, dec = "." ,skip=7,  header=FALSE, fill=TRUE)
select <- as.matrix (colombos_GSE1642)
boxplot(select,outline=FALSE)
# limma
y2 <- normalizeBetweenArrays(log2(select), method="quantile")
boxplot(y2,outline=FALSE)
#quantile
library("preprocessCore")
colombos_GSM27855_quantile=normalize.quantiles(select)
dim(colombos_GSM27855_quantile)
# 37 1
# 2 2
# 17 3
a=replicate(138, 1)
b=replicate(299, 2)
# c=replicate(17, 3)
# d=replicate(16, 4)
# e=replicate(6,5)
batch<- c(a,b)
length(batch)
dim(colombos_GSM27855_quantile)
library("sva")
colombos_GSM27855_quantile[is.na(colombos_GSM27855_quantile)] = 0
data_combat=ComBat(dat=colombos_GSM27855_quantile, batch=batch, mod=NULL, par.prior = TRUE, prior.plots = FALSE)
boxplot(data_combat,outline=FALSE)
#####
# MDS
mds = plotMDS(colombos_GSM27855_quantile,xlim=c(-2,2) ,xlab = "Dim1", ylim=c(-2,2), ylab = "Dim2", cex.lab= 1.5,pch = 15,cex=2, col=c( rep("black",6),  rep("red",12), rep("yellow",12), rep("orange",12))) #,rep("green",3),rep("deeppink",3),rep("gray",3), rep("pink",3)))
plotMDS(colombos_GSM27855_quantile,dim=c(3,4), col=batch)
#######
# Manual
# exp_PROM_Original.txt
expTable_PROM_original <- read.table("exp_PROM_Original.txt", header=TRUE, row.names=1, sep=",")
select <- as.matrix (expTable_PROM_original)
boxplot(select,outline=FALSE)
# limma
y2 <- normalizeBetweenArrays(log2(select), method="quantile")
boxplot(y2,outline=FALSE)
#quantile
library("preprocessCore")
colombos_GSM27855_quantile=normalize.quantiles(select)
boxplot(colombos_GSM27855_quantile,outline=FALSE)
boxplot(select,outline=FALSE)
select <- as.matrix (colombos_GSE1642)
boxplot(select,outline=FALSE)
expTable_PROM_original[is.na(expTable_PROM_original)] = 0
data_combat=ComBat(dat=expTable_PROM_original, batch=batch, mod=NULL, par.prior = TRUE, prior.plots = FALSE)
boxplot(data_combat,outline=FALSE)
#####
# MDS
mds = plotMDS(data_combat,xlim=c(-2,2) ,xlab = "Dim1", ylim=c(-2,2), ylab = "Dim2", cex.lab= 1.5,pch = 15,cex=2, col=c( rep("black",6),  rep("red",12), rep("yellow",12), rep("orange",12))) #,rep("green",3),rep("deeppink",3),rep("gray",3), rep("pink",3)))
plotMDS(colombos_GSM27855_quantile,dim=c(3,4), col=batch)
# exp colombos GSE1642
colombos_GSE1642 <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/analisys/colombos_GSE1642.txt",  row.names=1, dec = "." ,skip=7,  header=FALSE, fill=TRUE)
select <- as.matrix (colombos_GSE1642)
boxplot(select,outline=FALSE)
# limma
y2 <- normalizeBetweenArrays(log2(select), method="quantile")
boxplot(y2,outline=FALSE)
#quantile
library("preprocessCore")
select_quantile=normalize.quantiles(select)
boxplot(select_quantile,outline=FALSE)
#ComBat
#BiocManager::install("bladderbatch")
library("bladderbatch")
data(bladderdata)
dat <- bladderEset[1:50,]
pheno = pData(dat)
edata = exprs(dat)
batch = pheno$batch
#ComBat
#BiocManager::install("bladderbatch")
a=replicate(138, 1)
b=replicate(299, 2)
# c=replicate(17, 3)
# d=replicate(16, 4)
# e=replicate(6,5)
batch<- c(a,b)
length(batch)
dim(select_quantile)
library("sva")
select_quantile[is.na(select_quantile)] = 0
data_combat=ComBat(dat=select_quantile, batch=batch, mod=NULL, par.prior = TRUE, prior.plots = FALSE)
boxplot(data_combat,outline=FALSE)
#####
# MDS
mds = plotMDS(data_combat,xlim=c(-2,2) ,xlab = "Dim1", ylim=c(-2,2), ylab = "Dim2", cex.lab= 1.5,pch = 15,cex=2, col=c( rep("black",6),  rep("red",12), rep("yellow",12), rep("orange",12))) #,rep("green",3),rep("deeppink",3),rep("gray",3), rep("pink",3)))
plotMDS(colombos_GSM27855_quantile,dim=c(3,4), col=batch)
#####
# MDS
mds = plotMDS(select_quantile,xlim=c(-2,2) ,xlab = "Dim1", ylim=c(-2,2), ylab = "Dim2", cex.lab= 1.5,pch = 15,cex=2, col=c( rep("black",6),  rep("red",12), rep("yellow",12), rep("orange",12))) #,rep("green",3),rep("deeppink",3),rep("gray",3), rep("pink",3)))
plotMDS(select_quantile,dim=c(3,4), col=batch)
mds
View(mds)
expTable_PROM_original[is.na(expTable_PROM_original)] = 0
data_combat=ComBat(dat=expTable_PROM_original, batch=batch, mod=NULL, par.prior = TRUE, prior.plots = FALSE)
boxplot(data_combat,outline=FALSE)
#####
# MDS
mds = plotMDS(expTable_PROM_original,xlim=c(-2,2) ,xlab = "Dim1", ylim=c(-2,2), ylab = "Dim2", cex.lab= 1.5,pch = 15,cex=2, col=c( rep("black",6),  rep("red",12), rep("yellow",12), rep("orange",12))) #,rep("green",3),rep("deeppink",3),rep("gray",3), rep("pink",3)))
plotMDS(expTable_PROM_original,dim=c(3,4), col=batch)
# exp colombos GSE1642
colombos_GSE1642 <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/analisys/colombos_GSE1642.txt",  row.names=1, dec = "." ,skip=7,  header=FALSE, fill=TRUE)
select <- as.matrix (colombos_GSE1642)
# limma
y2 <- normalizeBetweenArrays(log2(select), method="quantile")
boxplot(y2,outline=FALSE)
#quantile
library("preprocessCore")
select_quantile=normalize.quantiles(select)
boxplot(select_quantile,outline=FALSE)
# c=replicate(17, 3)
# d=replicate(16, 4)
# e=replicate(6,5)
batch<- c(a,b)
length(batch)
dim(select_quantile)
library("sva")
select_quantile[is.na(select_quantile)] = 0
data_combat=ComBat(dat=select_quantile, batch=batch, mod=NULL, par.prior = TRUE, prior.plots = FALSE)
boxplot(data_combat,outline=FALSE)
#####
# MDS
mds = plotMDS(data_combat,xlim=c(-2,2) ,xlab = "Dim1", ylim=c(-2,2), ylab = "Dim2", cex.lab= 1.5,pch = 15,cex=2, col=c( rep("black",6),  rep("red",12), rep("yellow",12), rep("orange",12))) #,rep("green",3),rep("deeppink",3),rep("gray",3), rep("pink",3)))
plotMDS(data_combat,dim=c(3,4), col=batch)
#####
# MDS
mds = plotMDS(select_quantile,xlim=c(-2,2) ,xlab = "Dim1", ylim=c(-2,2), ylab = "Dim2", cex.lab= 1.5,pch = 15,cex=2, col=c( rep("black",6),  rep("red",12), rep("yellow",12), rep("orange",12))) #,rep("green",3),rep("deeppink",3),rep("gray",3), rep("pink",3)))
plotMDS(select_quantile,dim=c(3,4), col=batch)
#####
# MDS
mds = plotMDS(select,xlim=c(-2,2) ,xlab = "Dim1", ylim=c(-2,2), ylab = "Dim2", cex.lab= 1.5,pch = 15,cex=2, col=c( rep("black",6),  rep("red",12), rep("yellow",12), rep("orange",12))) #,rep("green",3),rep("deeppink",3),rep("gray",3), rep("pink",3)))
plotMDS(select,dim=c(3,4), col=batch)
select <- as.matrix (colombos_GSE1642)
# limma
y2 <- normalizeBetweenArrays(log2(select), method="quantile")
boxplot(y2,outline=FALSE)
#quantile
library("preprocessCore")
select_quantile=normalize.quantiles(select)
boxplot(select_quantile,outline=FALSE)
scale(t(select)))
scale(t(select))
select <- as.matrix (colombos_GSE1642)
boxplot(select,outline=FALSE)
select <- scale(t(select))
boxplot(select,outline=FALSE)
select <- as.matrix (colombos_GSE1642)
select_quantile=normalize.quantiles(select)
boxplot(select_quantile,outline=FALSE)
select_scale <- scale(t(select_quantile))
boxplot(select_scale,outline=FALSE)
# limma
y2 <- normalizeBetweenArrays(select), method="quantile")
select <- as.matrix (colombos_GSE1642)
# limma
y2 <- normalizeBetweenArrays(select, method="quantile")
boxplot(y2,outline=FALSE)
select <- as.matrix (colombos_GSE1642)
boxplot(select,outline=FALSE)
# limma
y2 <- normalizeBetweenArrays(select, method="quantile")
boxplot(y2,outline=FALSE)
a=replicate(138, 1)
b=replicate(299, 2)
# c=replicate(17, 3)
# d=replicate(16, 4)
# e=replicate(6,5)
batch<- c(a,b)
length(batch)
dim(select_quantile)
library("sva")
select_quantile[is.na(select_quantile)] = 0
data_combat=ComBat(dat=select_quantile, batch=batch, mod=NULL, par.prior = TRUE, prior.plots = FALSE)
boxplot(data_combat,outline=FALSE)
#####
# MDS
mds = plotMDS(data_combat,xlim=c(-2,2) ,xlab = "Dim1", ylim=c(-2,2), ylab = "Dim2", cex.lab= 1.5,pch = 15,cex=2, col=c( rep("black",6),  rep("red",12), rep("yellow",12), rep("orange",12))) #,rep("green",3),rep("deeppink",3),rep("gray",3), rep("pink",3)))
plotMDS(data_combat,dim=c(3,4), col=batch)
select <- as.matrix (colombos_GSE1642)
boxplot(select,outline=FALSE)
# limma
select_quantile <- normalizeBetweenArrays(select, method="quantile")
boxplot(select_quantile,outline=FALSE)
select <- as.matrix (colombos_16811_40846_9776_35362_14840)
boxplot(select,outline=FALSE)
# limma
select_quantile <- normalizeBetweenArrays(select, method="quantile")
boxplot(select_quantile,outline=FALSE)
select <- as.matrix (colombos_GSE1642)
boxplot(select,outline=FALSE)
# limma
select_quantile <- normalizeBetweenArrays(select, method="quantile")
boxplot(select_quantile,outline=FALSE)
#####
# MDS
mds = plotMDS(select_quantile,xlim=c(-2,2) ,xlab = "Dim1", ylim=c(-2,2), ylab = "Dim2", cex.lab= 1.5,pch = 15,cex=2, col=c( rep("black",6),  rep("red",12), rep("yellow",12), rep("orange",12))) #,rep("green",3),rep("deeppink",3),rep("gray",3), rep("pink",3)))
plotMDS(select_quantile,dim=c(3,4), col=batch)
select <- as.matrix (colombos_16811_40846_9776_35362_14840)
boxplot(select,outline=FALSE)
# limma
select_quantile <- normalizeBetweenArrays(select, method="quantile")
boxplot(select_quantile,outline=FALSE)
a=replicate(138, 1)
b=replicate(299, 2)
c=replicate(17, 3)
d=replicate(16, 4)
e=replicate(6,5)
batch<- c(a,b,c,d,e)
length(batch)
dim(select_quantile)
#a=replicate(138, 1)
#b=replicate(299, 2)
a=replicate(35, 1)
b=replicate(2, 2)
c=replicate(17, 3)
d=replicate(16, 4)
e=replicate(6,5)
batch<- c(a,b)
length(batch)
dim(select_quantile)
batch<- c(a,b,c,d,e)
length(batch)
dim(select_quantile)
library("sva")
select_quantile[is.na(select_quantile)] = 0
data_combat=ComBat(dat=select_quantile, batch=batch, mod=NULL, par.prior = TRUE, prior.plots = FALSE)
boxplot(data_combat,outline=FALSE)
#####
# MDS
mds = plotMDS(select_quantile,xlim=c(-2,2) ,xlab = "Dim1", ylim=c(-2,2), ylab = "Dim2", cex.lab= 1.5,pch = 15,cex=2, col=c( rep("black",6),  rep("red",12), rep("yellow",12), rep("orange",12))) #,rep("green",3),rep("deeppink",3),rep("gray",3), rep("pink",3)))
plotMDS(select_quantile,dim=c(3,4), col=batch)
#####
# MDS
mds = plotMDS(data_combat,xlim=c(-2,2) ,xlab = "Dim1", ylim=c(-2,2), ylab = "Dim2", cex.lab= 1.5,pch = 15,cex=2, col=c( rep("black",6),  rep("red",12), rep("yellow",12), rep("orange",12))) #,rep("green",3),rep("deeppink",3),rep("gray",3), rep("pink",3)))
plotMDS(data_combat,dim=c(3,4), col=batch)
select_quantile[is.na(select_quantile)] = 0
data_combat=ComBat(dat=select_quantile, batch=batch, mod=NULL, par.prior = TRUE, prior.plots = FALSE)
boxplot(data_combat,outline=FALSE)
#####
# MDS
mds = plotMDS(data_combat,xlim=c(-2,2) ,xlab = "Dim1", ylim=c(-2,2), ylab = "Dim2", cex.lab= 1.5,pch = 15,cex=2, col=c( rep("black",6),  rep("red",12), rep("yellow",12), rep("orange",12))) #,rep("green",3),rep("deeppink",3),rep("gray",3), rep("pink",3)))
plotMDS(data_combat,dim=c(3,4), col=batch)
#####
# MDS
mds = plotMDS(select_quantile,xlim=c(-2,2) ,xlab = "Dim1", ylim=c(-2,2), ylab = "Dim2", cex.lab= 1.5,pch = 15,cex=2, col=c( rep("black",6),  rep("red",12), rep("yellow",12), rep("orange",12))) #,rep("green",3),rep("deeppink",3),rep("gray",3), rep("pink",3)))
plotMDS(select_quantile,dim=c(3,4), col=batch)
select <- as.matrix (colombos_16811_40846_9776_35362_14840)
boxplot(select,outline=FALSE)
# limma
select_quantile <- normalizeBetweenArrays(select, method="quantile")
boxplot(select_quantile,outline=FALSE)
mds
