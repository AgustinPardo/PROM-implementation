# install.packages("readr")
# install.packages("tidyr")
# install.packages("survminer")
BiocManager::install("GEOquery")
#######
library(GEOquery)
install.packages("GEOquery")
source("https://bioconductor.org/biocLite.R")
version
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("GEOquery")
install.packages("BiocManager")
install.packages("forcats")
install.packages("stringr")
install.packages("BiocManager")
install.packages("BiocManager")
install.packages("forcats")
install.packages("stringr")
install.packages("ggplot2")
install.packages("ggrepel")
install.packages("readr")
install.packages("tidyr")
install.packages("survminer")
BiocManager::install("GEOquery")
BiocManager::install("limma")
BiocManager::install("pheatmap")
BiocManager::install("org.Hs.eg.db")
#######
library(GEOquery)
#######
# Manual
# exp_PROM_Original.txt
expTable_PROM_original <- read.table("exp_PROM_Original.txt", header=TRUE, row.names=1, sep=",")
colombos_all <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_mtube_exprdata_20151029.txt",  row.names=1, dec = "." ,skip=7,  header=FALSE, fill=TRUE)
colombos_all <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_mtube_exprdata_20151029.txt",  row.names=1, dec = "." ,skip=6,  header=TRUE, fill=TRUE)
colombos_all <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_mtube_exprdata_20151029.txt",  row.names=1, dec = "." ,skip=6,  header=FALSE, fill=TRUE)
colombos_all <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_all.txt",  row.names=1, dec = "." ,skip=6,  header=FALSE, fill=TRUE)
View(colombos_all)
colombos_all <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_all.txt",  row.names=1, dec = "." ,skip=6,  header=FALSE, fill=TRUE)
View(colombos_all)
colombos_all <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_all.txt",  row.names=1, dec = "." ,skip=5,  header=FALSE, fill=TRUE)
colombos_all <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_all.txt",  dec = "." ,skip=5,  header=FALSE, fill=TRUE)
batch=colombos_all[1,]
batch
batch=colombos_all[,1]
batch
batch=colombos_all[2,]
batch
batch=colombos_all[3,]
batch
batch=colombos_all[[1]]
batch
batch=colombos_all[[,1]]
batch=colombos_all[,1]
batch
batch=colombos_all[,2]
batch
source('~/FBA_Tesis/PROM_trabajo/COLOMBOS_data/analisys/exp_analisys.R', echo=TRUE)
batch
batch
batch=colombos_all[2,]
batch
typeof(colombos_all)
typeof(colombos_all)
batch=colombos_all[1]
batch
batch=colombos_all[1][1]
batch
batch=colombos_all[[2]]
batch
batch=colombos_all[[1]]
batch
batch=colombos_all[[],1]
batch=colombos_all[[1]]
batch
colombos_all <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_all.txt",  dec = "." ,skip=5,  header=FALSE, fill=TRUE)
select <- as.matrix (colombos_all)
select
select
View(select)
batch=select[[1]]
batch
batch=select[1:]
batch=select[1,]
batch
batch=select[[1,]]
batch=select[[1]]
batch
batch=select[[:]]
batch=select[[1]]
a <- c(1,2,3)
typeof(a)
batch=select[2,]
batch
batch=select[1,]
batch
typeof(batch)
as.vector(batch)
typeof(batch)
batch=as.vector(batch)
typeof(batch)
colombos_all <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_all.txt",  dec = "." ,skip=5,  header=FALSE, fill=TRUE)
select <- as.matrix (colombos_all)
batch=select[1,]
batch=as.vector(batch)
rownames(select) <- select[,1]
rownames(select) <- select[,1]
select[1,] <- NULL
select[1,]
colombos_all <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_all.txt",  dec = "." ,skip=5,  header=FALSE, fill=TRUE)
select <- as.matrix (colombos_all)
batch=select[1,]
batch=as.vector(batch)
rownames(select) <- select[,1]
rownames("GPL1343") <- NULL
rownames("LocusTag") <- NULL
select("GPL1343") <- NULL
select["GPL1343"] <- NULL
select <- select[2:,]
select <- select[2:]
select <- select[-2:]
select <- select[-2,]
select <- as.matrix (colombos_all)
batch=select[1,]
batch=as.vector(batch)
rownames(select) <- select[,1]
select <- select[-3,]
select <- select[-1:-2,]
select <- as.matrix (colombos_all)
batch=select[1,]
select <- select[-1:-2,]
colombos_all <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_all.txt",  dec = "." ,skip=5,  header=FALSE, fill=TRUE)
select <- as.matrix (colombos_all)
colombos_all <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_all.txt",  dec = "." ,skip=5,  header=FALSE, fill=TRUE)
select <- as.matrix (colombos_all)
batch=select[1,]
batch=as.vector(batch)
rownames(select) <- select[,1]
select <- select[-1:-2,]
boxplot(select,outline=FALSE)
colombos_9776 <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_9776.txt",  row.names=1, dec = "." ,skip=7,  header=FALSE, fill=TRUE)
select <- as.matrix (colombos_9776)
select <- as.matrix (colombos_all)
.
colombos_all <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_all.txt",  dec = "." ,skip=5,  header=FALSE, fill=TRUE)
select <- as.matrix (colombos_all)
batch=select[1,]
batch=as.vector(batch)
rownames(select) <- select[,1]
select <- select[-1:-2,]
select <- select[-1:-2, 1]
colombos_all <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_all.txt",  dec = "." ,skip=5,  header=FALSE, fill=TRUE)
select <- as.matrix (colombos_all)
batch=select[1,]
batch=as.vector(batch)
rownames(select) <- select[,1]
select <- select[-1:-2, 1:ncol(select)]
select
View(select)
select <- as.matrix (colombos_all)
batch=select[1,]
batch=as.vector(batch)
rownames(select) <- select[,1]
select <- select[-1:-2, 2:ncol(select)]
boxplot(select,outline=FALSE)
select[is.na(select)] <- 0
boxplot(select,outline=FALSE)
typeof(select)
select <- as.numeric (select)
typeof(select)
boxplot(select,outline=FALSE)
2
colombos_all <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_all.txt",  dec = "." ,skip=5,  header=FALSE, fill=TRUE)
select <- as.matrix (colombos_all)
batch=select[1,]
batch=as.vector(batch)
rownames(select) <- select[,1]
select <- select[-1:-2, 2:ncol(select)]
select <- as.numeric (select)
colombos_all <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_all.txt",  dec = "." ,skip=5,  header=FALSE, fill=TRUE)
select <- as.matrix (colombos_all)
batch=select[1,]
batch=as.vector(batch)
rownames(select) <- select[,1]
select <- select[-1:-2, 2:ncol(select)]
2
select <- mapply(select, FUN=as.numeric)
typeof(select)
boxplot(select,outline=FALSE)
colombos_all <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_all.txt", row.names=1, dec = "." ,skip=7,  header=FALSE, fill=TRUE)
select <- as.matrix (colombos_all)
View(select)
colombos_all <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_all.txt",  dec = "." ,skip=5,  header=FALSE, fill=TRUE)
select <- as.matrix (colombos_all)
batch=select[1,]
batch=as.vector(batch)
colombos_all <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_all.txt", dec = "." ,skip=7,  header=FALSE, fill=TRUE)
select <- as.matrix (colombos_all)
colombos_all <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_all.txt",  dec = "." ,skip=5,  header=FALSE, fill=TRUE)
select <- as.matrix (colombos_all)
batch=select[1,]
batch=as.vector(batch)
batch
colombos_all <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_all.txt", dec = "." ,skip=7,  header=FALSE, fill=TRUE)
colombos_all <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_all.txt", row.names=1, dec = "." ,skip=7,  header=FALSE, fill=TRUE)
select <- as.matrix (colombos_all)
select
typeof(select)
boxplot(select,outline=FALSE)
# limma
select_quantile <- normalizeBetweenArrays(select, method="quantile")
boxplot(select_quantile,outline=FALSE)
# limma
library("limma")
select_quantile <- normalizeBetweenArrays(select, method="quantile")
boxplot(select_quantile,outline=FALSE)
library("sva")
dim(select)
colombos_all <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_all.txt",  dec = "." ,skip=5,  header=FALSE, fill=TRUE)
select <- as.matrix (colombos_all)
colombos_all <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_all.txt",  dec = "." ,skip=5,  header=FALSE, fill=TRUE)
select <- as.matrix (colombos_all)
batch=select[1,]
batch=as.vector(batch)
select
load("~/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_GSE1642.txt")
load("~/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_mtube_GPL.txt")
colombos_mtube_GPL <- read.delim("~/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_mtube_GPL.txt", header=FALSE)
View(colombos_mtube_GPL)
colombos_mtube_GPL <- read.delim("~/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_mtube_GPL.txt", header=FALSE)
colombos_mtube_GPL <- as.matrix (colombos_mtube_GPL)
batch=colombos_mtube_GPL[1,]
batch
batch=colombos_mtube_GPL[2,]
colombos_mtube_GPL
colombos_mtube_GPL <- colombos_mtube_GPL[1, 3:ncol(colombos_mtube_GPL)]
colombos_mtube_GPL
colombos_mtube_GPL <- read.delim("~/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_mtube_GPL.txt", header=FALSE)
colombos_mtube_GPL <- as.matrix (colombos_mtube_GPL)
colombos_mtube_GPL <- colombos_mtube_GPL[1, 2:ncol(colombos_mtube_GPL)]
colombos_mtube_GPL <- colombos_mtube_GPL[1, 4:ncol(colombos_mtube_GPL)]
colombos_mtube_GPL <- read.delim("~/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_mtube_GPL.txt", header=FALSE)
colombos_mtube_GPL <- as.matrix (colombos_mtube_GPL)
colombos_mtube_GPL <- colombos_mtube_GPL[1, 4:ncol(colombos_mtube_GPL)]
colombos_mtube_GPL <- read.delim("~/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_mtube_GPL.txt", header=FALSE)
colombos_mtube_GPL <- as.matrix (colombos_mtube_GPL)
colombos_mtube_GPL <- colombos_mtube_GPL[1, 4:ncol(colombos_mtube_GPL)]
batch=colombos_mtube_GPL[2,]
batch=as.vector(batch)
batch
batch
colombos_all <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_all.txt", row.names=1, dec = "." ,skip=7,  header=FALSE, fill=TRUE)
dim(select)
#colombos_all <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_all.txt",  dec = "." ,skip=5,  header=FALSE, fill=TRUE)
colombos_mtube_GPL <- read.delim("~/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_mtube_GPL.txt", header=FALSE)
View(colombos_mtube_GPL)
dim(select)
colombos_all <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_all.txt",  dec = "." ,skip=5,  header=FALSE, fill=TRUE)
colombos_GPL <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_all.txt",  dec = "." ,skip=5,  header=FALSE, fill=TRUE)
View(colombos_GPL)
#colombos_mtube_GPL <- read.delim("~/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_mtube_GPL.txt", header=FALSE)
colombos_GPL <- as.matrix (colombos_GPL)
dim(colombos_GPL)
colombos_GPL <- colombos_GPL[1, 4:ncol(colombos_GPL)]
colombos_GPL
batch=as.vector(batch)
batch
ncol(colombos_GPL)
colombos_GPL
colombos_GPL <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_all.txt",  dec = "." ,skip=5,  header=FALSE, fill=TRUE)
#colombos_mtube_GPL <- read.delim("~/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_mtube_GPL.txt", header=FALSE)
colombos_GPL <- as.matrix (colombos_GPL)
colombos_GPL <- colombos_GPL[1,]
colombos_GPL
batch=as.vector(batch)
batch
colombos_all <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_all.txt", row.names=1, dec = "." ,skip=7,  header=FALSE, fill=TRUE)
select <- as.matrix (colombos_all)
dim(select)
View(colombos_all)
View(select)
colombos_GPL <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_all.txt",  dec = "." ,skip=5,  header=FALSE, fill=TRUE)
#colombos_mtube_GPL <- read.delim("~/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_mtube_GPL.txt", header=FALSE)
colombos_GPL <- as.matrix (colombos_GPL)
colombos_GPL <- colombos_GPL[1,]
batch=as.vector(batch)
colombos_GPL
colombos_GPL.names
names(colombos_GPL)
colombos_GPL
values(colombos_GPL)
typeof(colombos_GPL)
#batch=as.vector(batch)
names(colombos_GPL)
as.array(colombos_GPL)
batch=as.array(colombos_GPL)
batch
batch=names(batch)
batch
colombos_GPL
labels(colombos_GPL)
names(colombos_GPL)
uname(colombos_GPL)
colombos_GPL <- colombos_GPL[1,]
colombos_GPL <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_all.txt",  dec = "." ,skip=5,  header=FALSE, fill=TRUE)
#colombos_mtube_GPL <- read.delim("~/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_mtube_GPL.txt", header=FALSE)
colombos_GPL <- as.matrix (colombos_GPL)
colombos_GPL <- colombos_GPL[1,]
colombos_GPL
colombos_GPL[1]
batch=as.character(batch)
batch
colombos_GPL <- colombos_GPL[1,]
colombos_GPL <- colombos_GPL[1,]
colombos_GPL <- colombos_GPL[1,]
colombos_GPL <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_all.txt",  dec = "." ,skip=5,  header=FALSE, fill=TRUE)
#colombos_mtube_GPL <- read.delim("~/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_mtube_GPL.txt", header=FALSE)
colombos_GPL <- as.matrix (colombos_GPL)
colombos_GPL <- colombos_GPL[1,]
batch=as.character(batch)
batch
colombos_GPL.names
names(colombos_GPL)
colombos_GPL
batch=as.array(batch)
batch
colombos_GPL
colombos_GPL <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_all.txt",  dec = "." ,skip=5,  header=FALSE, fill=TRUE)
#colombos_mtube_GPL <- read.delim("~/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_mtube_GPL.txt", header=FALSE)
colombos_GPL <- as.matrix (colombos_GPL)
colombos_GPL <- colombos_GPL[1,]
colombos_GPL <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_all.txt",  dec = "." ,skip=5,  header=FALSE, fill=TRUE)
View(colombos_GPL)
colombos_GPL <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_all.txt",  dec = "." ,skip=5,  header=FALSE, fill=TRUE)
#colombos_mtube_GPL <- read.delim("~/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_mtube_GPL.txt", header=FALSE)
colombos_GPL <- as.matrix (colombos_GPL)
View(colombos_GPL)
View(colombos_GPL)
colombos_GPL <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_mtube_exprdata_20151029.txt",  dec = "." ,skip=5,  header=FALSE, fill=TRUE)
View(colombos_GPL)
#colombos_mtube_GPL <- read.delim("~/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_mtube_GPL.txt", header=FALSE)
colombos_GPL <- as.matrix (colombos_GPL)
colombos_GPL <- colombos_GPL[1,]
colombos_GPL
ncol(colombos_GPL)
#colombos_mtube_GPL <- read.delim("~/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_mtube_GPL.txt", header=FALSE)
colombos_GPL <- as.matrix (colombos_GPL)
colombos_GPL <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_mtube_exprdata_20151029.txt",  dec = "." ,skip=5,  header=FALSE, fill=TRUE)
colombos_all <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_all.txt", row.names=1, dec = "." ,skip=7,  header=FALSE, fill=TRUE)
View(colombos_all)
dim(colombos_GPL)
colombos_GPL <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_mtube_exprdata_20151029.txt",  dec = "." , skip=5,  header=FALSE, fill=TRUE)
dim(colombos_all)
colombos_mtube_GPL <- read.delim("~/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_mtube_GPL.txt", header=FALSE)
colombos_all <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_all.txt", row.names=1, dec = "." , skip=7,  header=FALSE, fill=TRUE)
colombos_mtube_GPL <- read.delim("~/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_mtube_GPL.txt", header=FALSE)
#colombos_GPL <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_mtube_exprdata_20151029.txt",  dec = "." , skip=5,  header=FALSE, fill=TRUE)
colombos_mtube_GPL <- read.delim("~/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_mtube_GPL.txt", header=FALSE)
colombos_mtube_GPL <- as.matrix (colombos_mtube_GPL)
colombos_mtube_GPL
View(colombos_mtube_GPL)
colombos_mtube_GPL
batch=colombos_mtube_GPL
colombos_all <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_all.txt", row.names=1, dec = "." ,skip=7,  header=FALSE, fill=TRUE)
select <- as.matrix (colombos_all)
#colombos_GPL <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_mtube_exprdata_20151029.txt",  dec = "." , skip=5,  header=FALSE, fill=TRUE)
colombos_mtube_GPL <- read.delim("~/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_mtube_GPL.txt", header=FALSE)
colombos_mtube_GPL <- as.matrix (colombos_mtube_GPL)
#colombos_GPL <- colombos_GPL[1,]
dim(colombos_GPL)
batch=colombos_mtube_GPL
#colombos_GPL <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_mtube_exprdata_20151029.txt",  dec = "." , skip=5,  header=FALSE, fill=TRUE)
colombos_mtube_GPL <- read.delim("~/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_mtube_GPL.txt", header=FALSE)
colombos_mtube_GPL <- as.matrix (colombos_mtube_GPL)
#colombos_GPL <- colombos_GPL[1,]
batch=colombos_mtube_GPL
colombos_all <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_all.txt", row.names=1, dec = "." ,skip=7,  header=FALSE, fill=TRUE)
select <- as.matrix (colombos_all)
dim(colombos_all)
boxplot(select,outline=FALSE)
# limma
library("limma")
select_quantile <- normalizeBetweenArrays(select, method="quantile")
boxplot(select_quantile,outline=FALSE)
select_quantile[is.na(select_quantile)] = 0
data_combat=ComBat(dat=select_quantile, batch=batch, mod=NULL, par.prior = TRUE, prior.plots = FALSE)
boxplot(data_combat,outline=FALSE)
library("sva")
select_quantile[is.na(select_quantile)] = 0
data_combat=ComBat(dat=select_quantile, batch=batch, mod=NULL, par.prior = TRUE, prior.plots = FALSE)
View(batch)
typeof(batch)
batch
typeof(batch)
a<-c(1,2,3)
a<-c(1,2,3)
a
as.vector(batch)
batch=as.vector(batch)
select_quantile[is.na(select_quantile)] = 0
data_combat=ComBat(dat=select_quantile, batch=batch, mod=NULL, par.prior = TRUE, prior.plots = FALSE)
boxplot(data_combat,outline=FALSE)
#####
# MDS
mds = plotMDS(select_quantile,xlim=c(-2,2) ,xlab = "Dim1", ylim=c(-2,2), ylab = "Dim2", cex.lab= 1.5,pch = 15,cex=2, col=c( rep("black",6),  rep("red",12), rep("yellow",12), rep("orange",12))) #,rep("green",3),rep("deeppink",3),rep("gray",3), rep("pink",3)))
plotMDS(select_quantile,dim=c(3,4), col=batch)
mds = plotMDS(data_combat,xlim=c(-2,2) ,xlab = "Dim1", ylim=c(-2,2), ylab = "Dim2", cex.lab= 1.5,pch = 15,cex=2, col=c( rep("black",6),  rep("red",12), rep("yellow",12), rep("orange",12))) #,rep("green",3),rep("deeppink",3),rep("gray",3), rep("pink",3)))
plotMDS(data_combat,dim=c(3,4), col=batch)
batch
unique(batch)
as.numeric(factor(batch))
batch
a=as.numeric(factor(batch))
a
batch_col=as.numeric(factor(batch))
plotMDS(select_quantile,dim=c(3,4), col=batch_col)
mds = plotMDS(data_combat,xlim=c(-2,2) ,xlab = "Dim1", ylim=c(-2,2), ylab = "Dim2", cex.lab= 1.5,pch = 15,cex=2, col=c( rep("black",6),  rep("red",12), rep("yellow",12), rep("orange",12))) #,rep("green",3),rep("deeppink",3),rep("gray",3), rep("pink",3)))
batch_col=as.numeric(factor(batch))
plotMDS(data_combat,dim=c(3,4), col=batch)
plotMDS(data_combat,dim=c(3,4), col=batch_col)
# MDS sin combat
mds = plotMDS(select_quantile,xlim=c(-2,2) ,xlab = "Dim1", ylim=c(-2,2), ylab = "Dim2", cex.lab= 1.5,pch = 15,cex=2, col=c( rep("black",6),  rep("red",12), rep("yellow",12), rep("orange",12))) #,rep("green",3),rep("deeppink",3),rep("gray",3), rep("pink",3)))
batch_col=as.numeric(factor(batch))
plotMDS(select_quantile,dim=c(3,4), col=batch_col)
plotMDS(data_combat,dim=c(3,4), col=batch_col, ylim=c(-0.4, 0.4))
plotMDS(data_combat,dim=c(3,4), col=batch_col, ylim=c(-0.6, 0.6), xlim=c(-0.6, 0.6))
plotMDS(select_quantile, dim=c(3,4), col=batch_col ,ylim=c(-0.6, 0.6), xlim=c(-0.6, 0.6))
## Draw a polygon defining an area on the graph -- This is a red square
xx = c(-0.3,-0.3,0.3,0.3)
yy = c(-0.3,0.3,-0.3,0.3)
# When density=0, col refers to the line colour
polygon(xx,yy, density=0, col="red")
## Draw a polygon defining an area on the graph -- This is a red square
xx = c(-0.3,-0.3,0.3,0.3)
yy = c(-0.3,0.3,0.3,-0.3)
# When density=0, col refers to the line colour
polygon(xx,yy, density=0, col="red")
# When density=0, col refers to the line colour
polygon(xx,yy, density=0, col="black")
xx = c(-0.4,-0.4,0.4,0.4)
yy = c(-0.4,0.4,0.4,-0.4)
# When density=0, col refers to the line colour
polygon(xx,yy, density=0, col="black")
plotMDS(data_combat,dim=c(3,4), col=batch_col, ylim=c(-0.6, 0.6), xlim=c(-0.6, 0.6))
xx = c(-0.4,-0.4,0.4,0.4)
yy = c(-0.4,0.4,0.4,-0.4)
# When density=0, col refers to the line colour
polygon(xx,yy, density=0, col="black")
plotMDS(select_quantile, dim=c(3,4), col=batch_col ,ylim=c(-0.6, 0.6), xlim=c(-0.6, 0.6))
xx = c(-0.4,-0.4,0.4,0.4)
yy = c(-0.4,0.4,0.4,-0.4)
# When density=0, col refers to the line colour
polygon(xx,yy, density=0, col="black")
#normalizo de nuevo?
select_quantile2 <- normalizeBetweenArrays(data_combat, method="quantile")
boxplot(select_quantile2,outline=FALSE)
# MDS sin combat
mds = plotMDS(select_quantile2,xlim=c(-2,2) ,xlab = "Dim1", ylim=c(-2,2), ylab = "Dim2", cex.lab= 1.5,pch = 15,cex=2, col=c( rep("black",6),  rep("red",12), rep("yellow",12), rep("orange",12))) #,rep("green",3),rep("deeppink",3),rep("gray",3), rep("pink",3)))
batch_col=as.numeric(factor(batch))
plotMDS(select_quantile2, dim=c(3,4), col=batch_col ,ylim=c(-0.6, 0.6), xlim=c(-0.6, 0.6))
xx = c(-0.4,-0.4,0.4,0.4)
yy = c(-0.4,0.4,0.4,-0.4)
# When density=0, col refers to the line colour
polygon(xx,yy, density=0, col="black")
boxplot(select_quantile2,outline=FALSE)
# Todo el data set de colombos
#colombos_GPL <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_mtube_exprdata_20151029.txt",  dec = "." , skip=5,  header=FALSE, fill=TRUE)
colombos_mtube_GPL <- read.delim("~/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_mtube_GPL.txt", header=FALSE)
colombos_mtube_GPL <- as.matrix (colombos_mtube_GPL)
#colombos_GPL <- colombos_GPL[1,]
batch=colombos_mtube_GPL
batch=as.vector(batch)
batch
l
colombos_all <- read.table("/h/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_GPL_sets/colombos_all.txt", row.names=1, dec = "." ,skip=7,  header=FALSE, fill=TRUE)
colombos_all <- read.table("/home/agustin/FBA_Tesis/PROM_trabajo/COLOMBOS_data/colombos_GPL_sets/colombos_all.txt", row.names=1, dec = "." ,skip=7,  header=FALSE, fill=TRUE)
select <- as.matrix (colombos_all)
boxplot(select,outline=FALSE)
# limma
library("limma")
select_quantile <- normalizeBetweenArrays(select, method="quantile")
boxplot(select_quantile,outline=FALSE)
library("sva")
select_quantile[is.na(select_quantile)] = 0
select_quantile <- normalizeBetweenArrays(select, method="quantile")
#select_quantile[is.na(select_quantile)] = 0
data_combat=ComBat(dat=select_quantile, batch=batch, mod=NULL, par.prior = TRUE, prior.plots = FALSE)
select_quantile[is.na(select_quantile)] = 0
data_combat=ComBat(dat=select_quantile, batch=batch, mod=NULL, par.prior = TRUE, prior.plots = FALSE)
boxplot(data_combat,outline=FALSE)
write.table(mat, file="_exoression_colombos_1021.txt", row.names=FALSE, col.names=FALSE)
# Set final. Exporto la matriz
write.table(data_combat, file="_exoression_colombos_1021.txt", row.names=FALSE, col.names=FALSE)
pwd
dir
dir()
path()
path
# Set final. Exporto la matriz
write.table(data_combat, file="expression_colombos_1021.txt", row.names=FALSE, col.names=FALSE)
# Set final. Exporto la matriz
write.table(data_combat, file="expression_colombos_1021.txt", row.names=FALSE, col.names=FALSE)
# Set final. Exporto la matriz
write.table(data_combat, file="expression_colombos_1021.txt", row.names=FALSE, col.names=FALSE)
# Set final. Exporto la matriz
write.table(data_combat, file="expression_colombos_1021.txt", row.names=FALSE, col.names=FALSE, sep = ",")
# Exporto expression id
rownames(data_combat)
# Exporto expression id
expressionid=rownames(data_combat)
write.table(expressionid, file="expressionid_colombos_1021.txt", row.names=FALSE, col.names=FALSE, sep = ",")
